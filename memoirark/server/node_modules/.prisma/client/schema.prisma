generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Chapter {
  id           String   @id @default(cuid())
  number       Int
  title        String
  summary      String   @default("")
  yearsCovered String   @default("[]")
  events       Event[]
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

model Person {
  id               String     @id @default(cuid())
  name             String
  role             String     @default("")
  relationshipType String     @default("")
  notes            String     @default("")
  events           Event[]
  artifacts        Artifact[]
  createdAt        DateTime   @default(now())
  updatedAt        DateTime   @updatedAt
}

model Song {
  id        String   @id @default(cuid())
  title     String
  artist    String
  era       String   @default("")
  keyLyric  String   @default("")
  notes     String   @default("")
  events    Event[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model TraumaCycle {
  id          String   @id @default(cuid())
  label       String
  startYear   Int
  endYear     Int
  description String   @default("")
  events      Event[]
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Event {
  id              String          @id @default(cuid())
  title           String
  date            DateTime?
  location        String?
  summary         String?
  emotionTags     String          @default("[]")
  notes           String?
  chapterId       String?
  traumaCycleId   String?
  chapter         Chapter?        @relation(fields: [chapterId], references: [id])
  traumaCycle     TraumaCycle?    @relation(fields: [traumaCycleId], references: [id])
  persons         Person[]
  songs           Song[]
  artifacts       Artifact[]
  synchronicities Synchronicity[]
  createdAt       DateTime        @default(now())
  updatedAt       DateTime        @updatedAt
}

model Artifact {
  id               String   @id @default(cuid())
  type             String
  sourceSystem     String   @default("")
  sourcePathOrUrl  String   @default("")
  shortDescription String   @default("")
  transcribedText  String?
  events           Event[]
  persons          Person[]
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt
}

model Synchronicity {
  id          String    @id @default(cuid())
  date        DateTime?
  type        String
  description String    @default("")
  events      Event[]
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
}
